<!DOCTYPE html>
<html>
<head>
    <title>MusicPlayer</title>
	<link rel="stylesheet" type="text/css" href="ui_elements.css">
</head>

<script>
var g_player = null;	

//------------------------------------------
//
//------------------------------------------
function OnOffCtrl(parent, id, text)
{
	var ctrl = document.createElement("span");
	parent.appendChild(ctrl);

	ctrl.innerText = text;	
	
	//...
	fileNameCtrl
	fileNameCtrl.owner = ctrl;

	
	ctrl.SetOn = function(isOn)
	{
		this.isOn = isOn;
		if(this.isOn) this.className = "OnOffCtrlStyle_On";
		else this.className = "OnOffCtrlStyle_Off";
	}
	
	ctrl.onclick = function()
	{
		this.SetOn(!this.isOn);
	}

	ctrl.SetOn(false);
	
	return ctrl;
}

//------------------------------------------
//
//------------------------------------------
function CreateFileListControl(parent, id, fileList)
{
	var ctrl = document.createElement("span");
	parent.appendChild(ctrl);
	
	for(var i = 0; i < fileList.length; ++i)
	{
		fileName = fileList[i];
		
		
		var div_file = document.createElement("div");
		ctrl.appendChild(div_file);
		
		div_file.innerText = fileName;
		div_file.owner = ctrl;
		
		div_file.className = "fileListElementStyle";
		div_file.onclick = function()
		{
			this.owner.InformFileClicked(this);
		}
		
	}
	
	ctrl.currentlyClickedElement = null;
	
	ctrl.InformFileClicked = function(elem)
	{
		if(elem != this.currentlyClickedElement)
		{	

			if(this.currentlyClickedElement)
				this.currentlyClickedElement.className = "fileListElementStyle";

			if(elem)
				elem.className = "fileListElementClicked";

			this.currentlyClickedElement = elem;

		}
		
		if(this.onSelectionChanged) this.onSelectionChanged(elem.innerHTML);
		
	}
	
	return ctrl;
}


//------------------------------------------
//
//------------------------------------------

function  findFilesDir(dir, result) {
	fs = require('fs');

	var contents = fs.readdirSync(dir);
	
	for(var t = 0; t < contents.length; ++t) {
		var path = dir + contents[t];
		var isDirectory = fs.lstatSync(path).isDirectory();	
		if(!isDirectory) result.push(path);
		else findFilesDir(path, result);
	}
}

function onPageReady( )
{
	var files2display = new Array();
	findFilesDir("./songs/", files2display);
	
	var ctrl = CreateFileListControl(document.getElementById("container"), "availableSongs", files2display);
	g_player = new Player();
	
	ctrl.onSelectionChanged = function(elem) {
		var audio = document.getElementById("audiotag_player");
		audio.setAttribute("src", elem);
		audio.play();
	}
}
</script>

<script type="text/javascript" src="audiocontext.js"></script>

<body onLoad="onPageReady()">


<audio id="audiotag_player" controls>
</audio>

<span id = "Repeat"></span>
<span id = "Shuffle"></span>
<span id = "gergana"></span>
<div id = "container" style="width: 300px; display: block;"></div>
<div id = "soundScroll" style="position: relative"></div>
</br>

<div id = "soundScroll2" style="position: absolute; left: 100px"></div>

	
</body>
</html>
